<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç”Ÿç”£ç®¡ç†3ç´šãƒ—ãƒ©ãƒ³ãƒ‹ãƒ³ã‚°è©¦é¨“ç¯„å›²ã‚«ãƒãƒ¼ç‡åˆ†æãƒ¬ãƒãƒ¼ãƒˆ</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Hiragino Sans', 'Hiragino Kaku Gothic ProN', 'Yu Gothic', 'Meiryo', sans-serif;
            line-height: 1.8;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        .page {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            padding: 60px;
            margin-bottom: 40px;
            page-break-after: always;
            min-height: calc(100vh - 80px);
            display: flex;
            flex-direction: column;
        }

        .page:last-child {
            page-break-after: auto;
        }

        .header {
            text-align: center;
            margin-bottom: 50px;
            padding-bottom: 30px;
            border-bottom: 3px solid #667eea;
        }

        .header h1 {
            font-size: 2.5em;
            color: #2d3748;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .header .meta {
            color: #718096;
            font-size: 1.1em;
        }

        .section-title {
            font-size: 2em;
            color: #667eea;
            margin: 40px 0 30px 0;
            padding-bottom: 15px;
            border-bottom: 2px solid #e2e8f0;
            font-weight: 600;
        }

        .highlight-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            border-radius: 15px;
            margin: 30px 0;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
        }

        .highlight-box h2 {
            font-size: 1.8em;
            margin-bottom: 20px;
        }

        .highlight-box .big-number {
            font-size: 4em;
            font-weight: 700;
            margin: 20px 0;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
            margin: 40px 0;
        }

        .stat-card {
            background: #f7fafc;
            padding: 30px;
            border-radius: 12px;
            border-left: 5px solid #667eea;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .stat-card h3 {
            color: #2d3748;
            font-size: 1.2em;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .stat-card .number {
            font-size: 2.5em;
            font-weight: 700;
            color: #667eea;
            margin: 10px 0;
        }

        .stat-card .label {
            color: #718096;
            font-size: 0.95em;
        }

        .coverage-table {
            width: 100%;
            border-collapse: collapse;
            margin: 30px 0;
            background: white;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            border-radius: 10px;
            overflow: hidden;
        }

        .coverage-table thead {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .coverage-table th {
            padding: 18px;
            text-align: left;
            font-weight: 600;
            font-size: 1em;
        }

        .coverage-table td {
            padding: 15px 18px;
            border-bottom: 1px solid #e2e8f0;
        }

        .coverage-table tbody tr:hover {
            background: #f7fafc;
        }

        .coverage-badge {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9em;
        }

        .coverage-high {
            background: #c6f6d5;
            color: #22543d;
        }

        .coverage-medium {
            background: #feebc8;
            color: #7c2d12;
        }

        .coverage-low {
            background: #fed7d7;
            color: #742a2a;
        }

        .coverage-none {
            background: #e2e8f0;
            color: #4a5568;
        }

        .strength-weakness {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 30px 0;
        }

        .strength-box,
        .weakness-box {
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .strength-box {
            background: linear-gradient(135deg, #c6f6d5 0%, #9ae6b4 100%);
            border-left: 5px solid #22543d;
        }

        .weakness-box {
            background: linear-gradient(135deg, #fed7d7 0%, #fc8181 100%);
            border-left: 5px solid #742a2a;
        }

        .strength-box h3,
        .weakness-box h3 {
            font-size: 1.5em;
            margin-bottom: 20px;
            color: #2d3748;
        }

        .strength-box ul,
        .weakness-box ul {
            list-style: none;
            padding-left: 0;
        }

        .strength-box li,
        .weakness-box li {
            padding: 10px 0;
            padding-left: 25px;
            position: relative;
        }

        .strength-box li:before {
            content: "âœ“";
            position: absolute;
            left: 0;
            color: #22543d;
            font-weight: bold;
            font-size: 1.2em;
        }

        .weakness-box li:before {
            content: "âš ";
            position: absolute;
            left: 0;
            color: #742a2a;
            font-weight: bold;
            font-size: 1.2em;
        }

        .proposal-card {
            background: #f7fafc;
            padding: 30px;
            border-radius: 12px;
            margin: 25px 0;
            border-left: 5px solid #667eea;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .proposal-card h3 {
            color: #667eea;
            font-size: 1.4em;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .proposal-card .priority {
            display: inline-block;
            background: #fed7d7;
            color: #742a2a;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .proposal-card ul {
            margin-left: 20px;
            margin-top: 15px;
        }

        .proposal-card li {
            margin: 8px 0;
            color: #4a5568;
        }

        .impact-badge {
            display: inline-block;
            background: #667eea;
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
            margin-top: 10px;
        }

        .page-navigation {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: white;
            padding: 15px 25px;
            border-radius: 50px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            z-index: 1000;
        }

        .page-navigation button {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 0 5px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: background 0.3s ease;
        }

        .page-navigation button:hover {
            background: #764ba2;
        }

        .page-navigation button:disabled {
            background: #cbd5e0;
            cursor: not-allowed;
        }

        @media print {
            body {
                background: white;
            }

            .page {
                box-shadow: none;
                margin-bottom: 0;
            }

            .page-navigation {
                display: none;
            }
        }

        .chart-container {
            position: relative;
            height: 400px;
            margin: 30px 0;
            padding: 20px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .chart-title {
            font-size: 1.3em;
            color: #2d3748;
            margin-bottom: 20px;
            font-weight: 600;
            text-align: center;
        }

        .chart-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 30px;
            margin: 30px 0;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            border-radius: 10px;
            overflow: hidden;
            font-size: 0.9em;
        }

        .comparison-table thead {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .comparison-table th {
            padding: 12px 15px;
            text-align: left;
            font-weight: 600;
            font-size: 0.95em;
            border-right: 1px solid rgba(255, 255, 255, 0.2);
        }

        .comparison-table th:last-child {
            border-right: none;
        }

        .comparison-table td {
            padding: 10px 15px;
            border-bottom: 1px solid #e2e8f0;
            border-right: 1px solid #e2e8f0;
            vertical-align: top;
        }

        .comparison-table td:last-child {
            border-right: none;
        }

        .comparison-table tbody tr:hover {
            background: #f7fafc;
        }

        .comparison-table .match-cell {
            background: #c6f6d5;
            color: #22543d;
            font-weight: 600;
        }

        .comparison-table .no-match-cell {
            background: #fed7d7;
            color: #742a2a;
        }

        .comparison-table .supplement-cell {
            background: #bee3f8;
            color: #2c5282;
            font-weight: 600;
        }

        .comparison-table .section-header {
            background: #edf2f7;
            font-weight: 700;
            color: #2d3748;
        }

        .comparison-table .subsection-header {
            background: #f7fafc;
            font-weight: 600;
            color: #4a5568;
        }

        /* å›ºå®šãƒ˜ãƒƒãƒ€ãƒ¼ã¨ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ */
        .top-toolbar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: white;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .toolbar-left {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .toolbar-right {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .search-box {
            padding: 10px 15px;
            border: 2px solid #e2e8f0;
            border-radius: 25px;
            font-size: 0.95em;
            width: 300px;
            transition: border-color 0.3s ease;
        }

        .search-box:focus {
            outline: none;
            border-color: #667eea;
        }

        .toolbar-button {
            padding: 10px 20px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 0.95em;
            font-weight: 600;
            transition: background 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .toolbar-button:hover {
            background: #764ba2;
        }

        .toolbar-button.secondary {
            background: #e2e8f0;
            color: #4a5568;
        }

        .toolbar-button.secondary:hover {
            background: #cbd5e0;
        }

        body {
            padding-top: 80px;
        }

        /* ç›®æ¬¡ */
        .table-of-contents {
            position: fixed;
            right: 30px;
            top: 100px;
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            max-width: 250px;
            max-height: calc(100vh - 120px);
            overflow-y: auto;
            z-index: 999;
        }

        .table-of-contents h3 {
            font-size: 1.1em;
            color: #2d3748;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e2e8f0;
        }

        .toc-item {
            padding: 8px 12px;
            margin: 5px 0;
            border-radius: 6px;
            cursor: pointer;
            transition: background 0.3s ease;
            font-size: 0.9em;
            color: #4a5568;
        }

        .toc-item:hover {
            background: #f7fafc;
            color: #667eea;
        }

        .toc-item.active {
            background: #667eea;
            color: white;
        }

        /* è¦ç´„ãƒœãƒƒã‚¯ã‚¹ */
        .summary-box {
            background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%);
            padding: 25px;
            border-radius: 12px;
            border-left: 5px solid #667eea;
            margin: 30px 0;
        }

        .summary-box h4 {
            color: #667eea;
            font-size: 1.2em;
            margin-bottom: 15px;
        }

        .summary-box ul {
            list-style: none;
            padding-left: 0;
        }

        .summary-box li {
            padding: 8px 0;
            padding-left: 25px;
            position: relative;
            color: #4a5568;
        }

        .summary-box li:before {
            content: "â–¶";
            position: absolute;
            left: 0;
            color: #667eea;
        }

        /* ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ */
        .filter-buttons {
            display: flex;
            gap: 10px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 8px 16px;
            border: 2px solid #e2e8f0;
            background: white;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.3s ease;
        }

        .filter-btn:hover {
            border-color: #667eea;
            color: #667eea;
        }

        .filter-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        /* ãƒã‚¤ãƒ©ã‚¤ãƒˆ */
        .highlight {
            background: yellow;
            padding: 2px 4px;
            border-radius: 3px;
        }

        /* å°åˆ·æ™‚ã®èª¿æ•´ */
        @media print {

            .top-toolbar,
            .table-of-contents,
            .page-navigation {
                display: none !important;
            }

            body {
                padding-top: 0;
                background: white;
            }

            .page {
                box-shadow: none;
                margin-bottom: 0;
                page-break-after: always;
            }
        }

        @media (max-width: 1200px) {
            .table-of-contents {
                display: none;
            }
        }

        @media (max-width: 768px) {
            .page {
                padding: 30px 20px;
            }

            .header h1 {
                font-size: 1.8em;
            }

            .strength-weakness {
                grid-template-columns: 1fr;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .chart-grid {
                grid-template-columns: 1fr;
            }

            .chart-container {
                height: 300px;
            }
        }
    </style>
</head>

<body>
    <!-- å›ºå®šãƒ„ãƒ¼ãƒ«ãƒãƒ¼ -->
    <div class="top-toolbar">
        <div class="toolbar-left">
            <h2 style="margin: 0; color: #667eea; font-size: 1.3em;">ç”Ÿç”£ç®¡ç†3ç´š ã‚«ãƒãƒ¼ç‡åˆ†æ</h2>
            <input type="text" id="searchInput" class="search-box" placeholder="ğŸ” æ¤œç´¢...">
        </div>
        <div class="toolbar-right">
            <button class="toolbar-button secondary" onclick="printReport()">ğŸ“„ å°åˆ·</button>
            <button class="toolbar-button" onclick="exportToPDF()">ğŸ’¾ PDFä¿å­˜</button>
        </div>
    </div>

    <!-- ç›®æ¬¡ -->
    <div class="table-of-contents">
        <h3>ğŸ“‘ ç›®æ¬¡</h3>
        <div class="toc-item" onclick="goToPage(1)">1. ã‚¨ã‚°ã‚¼ã‚¯ãƒ†ã‚£ãƒ–ã‚µãƒãƒªãƒ¼</div>
        <div class="toc-item" onclick="goToPage(2)">2. è©³ç´°åˆ†æ</div>
        <div class="toc-item" onclick="goToPage(3)">3. æ”¹å–„ææ¡ˆ</div>
    </div>

    <div class="container">
        <!-- ãƒšãƒ¼ã‚¸1: ã‚¨ã‚°ã‚¼ã‚¯ãƒ†ã‚£ãƒ–ã‚µãƒãƒªãƒ¼ -->
        <div class="page" id="page1">
            <div class="header">
                <h1>ç”Ÿç”£ç®¡ç†3ç´šãƒ—ãƒ©ãƒ³ãƒ‹ãƒ³ã‚°è©¦é¨“ç¯„å›²<br>ã‚«ãƒãƒ¼ç‡åˆ†æãƒ¬ãƒãƒ¼ãƒˆ</h1>
                <div class="meta">
                    <strong>ä½œæˆæ—¥:</strong> 2025å¹´11æœˆ7æ—¥<br>
                    <strong>åˆ†æå¯¾è±¡:</strong> ç”Ÿç”£ç®¡ç†3ç´šãƒ—ãƒ©ãƒ³ãƒ‹ãƒ³ã‚°è©¦é¨“ç¯„å›² vs é›»æ°—é›»å­ãƒ»æ©Ÿæ¢°è¨­è¨ˆå‘ã‘è¬›åº§
                </div>
            </div>

            <div class="summary-box">
                <h4>ğŸ“‹ ã“ã®ãƒšãƒ¼ã‚¸ã®è¦ç‚¹</h4>
                <ul>
                    <li>å…¨ä½“ã‚«ãƒãƒ¼ç‡ã¯20.1%ã§ã€æ”¹å–„ã®ä½™åœ°ãŒå¤§ãã„</li>
                    <li>å“è³ªç®¡ç†é ˜åŸŸã¯68.0%ã¨é«˜ã„ãŒã€å°‚é–€çŸ¥è­˜ã¯14.6%ã«ç•™ã¾ã‚‹</li>
                    <li>æœªå¯¾å¿œé …ç›®ã¯64é …ç›®ï¼ˆå…¨ä½“ã®62.1%ï¼‰</li>
                    <li>ç”Ÿç”£è¨ˆç”»ãƒ»å·¥ç¨‹ç®¡ç†ã€åŸä¾¡ç®¡ç†ãŒå®Œå…¨æœªå¯¾å¿œ</li>
                </ul>
            </div>

            <div class="highlight-box">
                <h2>ç·åˆã‚«ãƒãƒ¼ç‡</h2>
                <div class="big-number">20.1%</div>
                <p style="font-size: 1.2em; margin-top: 20px;">
                    103é …ç›®ä¸­ã€å®Œå…¨å¯¾å¿œï¼ˆ80%ä»¥ä¸Šï¼‰ã¯6é …ç›®ã®ã¿<br>
                    æœªå¯¾å¿œé …ç›®ã¯64é …ç›®ï¼ˆå…¨ä½“ã®62.1%ï¼‰
                </p>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <h3>å°‚é–€çŸ¥è­˜</h3>
                    <div class="number">14.6%</div>
                    <div class="label">26é …ç›®ä¸­ã€å¯¾å¿œ4é …ç›®</div>
                </div>
                <div class="stat-card">
                    <h3>å…±é€šçŸ¥è­˜</h3>
                    <div class="number">21.9%</div>
                    <div class="label">77é …ç›®ä¸­ã€å¯¾å¿œ20é …ç›®</div>
                </div>
                <div class="stat-card">
                    <h3>å®Œå…¨å¯¾å¿œ</h3>
                    <div class="number">6</div>
                    <div class="label">é …ç›®ï¼ˆ80%ä»¥ä¸Šï¼‰</div>
                </div>
                <div class="stat-card">
                    <h3>æœªå¯¾å¿œ</h3>
                    <div class="number">64</div>
                    <div class="label">é …ç›®ï¼ˆ0%ï¼‰</div>
                </div>
            </div>

            <div class="section-title">ä¸»è¦ãªç™ºè¦‹</div>

            <div class="strength-weakness">
                <div class="strength-box">
                    <h3>âœ“ å¼·ã¿</h3>
                    <ul>
                        <li>å“è³ªç®¡ç†é ˜åŸŸã§68.0%ã®é«˜ã„ã‚«ãƒãƒ¼ç‡ã‚’é”æˆ</li>
                        <li>å“è³ªç®¡ç†åŸºæœ¬ã‚·ãƒªãƒ¼ã‚ºãŒä½“ç³»çš„ã‚«ãƒªã‚­ãƒ¥ãƒ©ãƒ ã‚’æä¾›</li>
                        <li>QCçš„æ€è€ƒæ³•ï¼ˆPDCAã€ãƒ‡ãƒ¼ã‚¿ä¸»ç¾©ï¼‰ã®å¾¹åº•çš„æ•™è‚²</li>
                        <li>æ©Ÿæ¢°è¨­è¨ˆãƒ»è£½å›³ã®å®Ÿå‹™çš„æŠ€è¡“æ•™è‚²ãŒå……å®Ÿ</li>
                    </ul>
                </div>
                <div class="weakness-box">
                    <h3>âš  èª²é¡Œ</h3>
                    <ul>
                        <li>ç”Ÿç”£è¨ˆç”»ãƒ»å·¥ç¨‹ç®¡ç†ãŒå®Œå…¨æœªå¯¾å¿œï¼ˆ0%ï¼‰</li>
                        <li>åŸä¾¡ç®¡ç†21é …ç›®ãŒå®Œå…¨æœªå¯¾å¿œ</li>
                        <li>ç´æœŸç®¡ç†11é …ç›®ãŒå®Œå…¨æœªå¯¾å¿œ</li>
                        <li>ç’°å¢ƒç®¡ç†14é …ç›®ãŒå®Œå…¨æœªå¯¾å¿œ</li>
                    </ul>
                </div>
            </div>

            <div class="chart-grid">
                <div class="chart-container">
                    <div class="chart-title">å°‚é–€çŸ¥è­˜ vs å…±é€šçŸ¥è­˜ ã‚«ãƒãƒ¼ç‡æ¯”è¼ƒ</div>
                    <canvas id="coverageComparisonChart"></canvas>
                </div>
                <div class="chart-container">
                    <div class="chart-title">å¯¾å¿œçŠ¶æ³ã®å†…è¨³</div>
                    <canvas id="coverageStatusChart"></canvas>
                </div>
            </div>

            <div style="margin-top: 40px; padding: 30px; background: #edf2f7; border-radius: 12px;">
                <h3 style="color: #2d3748; margin-bottom: 15px; font-size: 1.3em;">ğŸ“Š ã‚«ãƒãƒ¼ç‡åˆ†å¸ƒ</h3>
                <table class="coverage-table">
                    <thead>
                        <tr>
                            <th>åŒºåˆ†</th>
                            <th>ç·é …ç›®æ•°</th>
                            <th>å¯¾å¿œé …ç›®æ•°<br>(80%ä»¥ä¸Š)</th>
                            <th>ä¸€éƒ¨å¯¾å¿œ<br>(50-79%)</th>
                            <th>é™å®šçš„å¯¾å¿œ<br>(1-49%)</th>
                            <th>æœªå¯¾å¿œ<br>(0%)</th>
                            <th>å¹³å‡ã‚«ãƒãƒ¼ç‡</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>ã€å°‚é–€çŸ¥è­˜ã€‘</strong></td>
                            <td>26</td>
                            <td>0</td>
                            <td>4</td>
                            <td>4</td>
                            <td>18</td>
                            <td><strong>14.6%</strong></td>
                        </tr>
                        <tr>
                            <td><strong>ã€å…±é€šçŸ¥è­˜ã€‘</strong></td>
                            <td>77</td>
                            <td>6</td>
                            <td>14</td>
                            <td>11</td>
                            <td>46</td>
                            <td><strong>21.9%</strong></td>
                        </tr>
                        <tr style="background: #f7fafc; font-weight: 600;">
                            <td><strong>å…¨ä½“</strong></td>
                            <td>103</td>
                            <td>6</td>
                            <td>18</td>
                            <td>15</td>
                            <td>64</td>
                            <td><strong>20.1%</strong></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- ãƒšãƒ¼ã‚¸2: è©³ç´°åˆ†æ -->
        <div class="page" id="page2">
            <div class="header">
                <h1>è©³ç´°åˆ†æ</h1>
                <div class="meta">ã‚»ã‚¯ã‚·ãƒ§ãƒ³åˆ¥ã‚«ãƒãƒ¼ç‡ã¨å¯¾å¿œçŠ¶æ³</div>
            </div>

            <div class="summary-box">
                <h4>ğŸ“‹ ã“ã®ãƒšãƒ¼ã‚¸ã®è¦ç‚¹</h4>
                <ul>
                    <li>å°‚é–€çŸ¥è­˜ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¯å¹³å‡14.6%ã¨ä½ã„</li>
                    <li>å…±é€šçŸ¥è­˜ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¯å¹³å‡21.9%ã€å“è³ªç®¡ç†ã¯68.0%</li>
                    <li>åŸä¾¡ç®¡ç†ã€ç´æœŸç®¡ç†ã€ç’°å¢ƒç®¡ç†ãŒå®Œå…¨æœªå¯¾å¿œ</li>
                    <li>è¬›åº§ä¸€è¦§ã¨è©¦é¨“ç¯„å›²ã®è©³ç´°å¯¾å¿œè¡¨ã‚’æ²è¼‰</li>
                </ul>
            </div>

            <div class="filter-buttons">
                <button class="filter-btn active" onclick="filterTable('all', event)">ã™ã¹ã¦</button>
                <button class="filter-btn" onclick="filterTable('match', event)">âœ“ å¯¾å¿œæ¸ˆã¿</button>
                <button class="filter-btn" onclick="filterTable('no-match', event)">æœªå¯¾å¿œ</button>
                <button class="filter-btn" onclick="filterTable('specialized', event)">å°‚é–€çŸ¥è­˜</button>
                <button class="filter-btn" onclick="filterTable('common', event)">å…±é€šçŸ¥è­˜</button>
            </div>

            <div class="section-title">ã€å°‚é–€çŸ¥è­˜ã€‘ã‚»ã‚¯ã‚·ãƒ§ãƒ³</div>

            <div class="chart-container">
                <div class="chart-title">å°‚é–€çŸ¥è­˜ã‚»ã‚¯ã‚·ãƒ§ãƒ³åˆ¥ã‚«ãƒãƒ¼ç‡</div>
                <canvas id="specializedKnowledgeChart"></canvas>
            </div>

            <table class="coverage-table">
                <thead>
                    <tr>
                        <th>ã‚»ã‚¯ã‚·ãƒ§ãƒ³</th>
                        <th>é …ç›®æ•°</th>
                        <th>å¹³å‡ã‚«ãƒãƒ¼ç‡</th>
                        <th>çŠ¶æ³</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>â… . ç”Ÿç”£ã‚·ã‚¹ãƒ†ãƒ ã¨ç”Ÿç”£å½¢æ…‹</strong></td>
                        <td>5</td>
                        <td><span class="coverage-badge coverage-none">0%</span></td>
                        <td>å®Œå…¨æœªå¯¾å¿œ</td>
                    </tr>
                    <tr>
                        <td><strong>â…¡. è£½å“ä¼ç”»ã¨è¨­è¨ˆç®¡ç†</strong></td>
                        <td>7</td>
                        <td><span class="coverage-badge coverage-low">45.7%</span></td>
                        <td>éƒ¨åˆ†å¯¾å¿œï¼ˆæŠ€è¡“çš„å´é¢ã®ã¿ï¼‰</td>
                    </tr>
                    <tr>
                        <td><strong>â…¢. å·¥ç¨‹ç®¡ç†ã«ãŠã‘ã‚‹ç”Ÿç”£è¨ˆç”»</strong></td>
                        <td>8</td>
                        <td><span class="coverage-badge coverage-none">0%</span></td>
                        <td>å®Œå…¨æœªå¯¾å¿œ</td>
                    </tr>
                    <tr>
                        <td><strong>â…£. è³‡æãƒ»åœ¨åº«ç®¡ç†ã¨ç”Ÿç”£ã‚·ã‚¹ãƒ†ãƒ </strong></td>
                        <td>6</td>
                        <td><span class="coverage-badge coverage-low">10.0%</span></td>
                        <td>é™å®šçš„å¯¾å¿œ</td>
                    </tr>
                </tbody>
            </table>

            <div class="section-title" style="margin-top: 50px;">ã€å…±é€šçŸ¥è­˜ã€‘ã‚»ã‚¯ã‚·ãƒ§ãƒ³</div>

            <div class="chart-container">
                <div class="chart-title">å…±é€šçŸ¥è­˜ã‚»ã‚¯ã‚·ãƒ§ãƒ³åˆ¥ã‚«ãƒãƒ¼ç‡</div>
                <canvas id="commonKnowledgeChart"></canvas>
            </div>

            <table class="coverage-table">
                <thead>
                    <tr>
                        <th>ã‚»ã‚¯ã‚·ãƒ§ãƒ³</th>
                        <th>é …ç›®æ•°</th>
                        <th>å¹³å‡ã‚«ãƒãƒ¼ç‡</th>
                        <th>çŠ¶æ³</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>â… . å“è³ªç®¡ç†</strong></td>
                        <td>20</td>
                        <td><span class="coverage-badge coverage-high">68.0%</span></td>
                        <td>é«˜ã„ã‚«ãƒãƒ¼ç‡</td>
                    </tr>
                    <tr>
                        <td><strong>â…¡. åŸä¾¡ç®¡ç†</strong></td>
                        <td>21</td>
                        <td><span class="coverage-badge coverage-none">0%</span></td>
                        <td>å®Œå…¨æœªå¯¾å¿œ</td>
                    </tr>
                    <tr>
                        <td><strong>â…¢. ç´æœŸç®¡ç†</strong></td>
                        <td>11</td>
                        <td><span class="coverage-badge coverage-none">0%</span></td>
                        <td>å®Œå…¨æœªå¯¾å¿œ</td>
                    </tr>
                    <tr>
                        <td><strong>â…£. å®‰å…¨è¡›ç”Ÿç®¡ç†</strong></td>
                        <td>11</td>
                        <td><span class="coverage-badge coverage-low">30.0%</span></td>
                        <td>é™å®šçš„å¯¾å¿œ</td>
                    </tr>
                    <tr>
                        <td><strong>â…¤. ç’°å¢ƒç®¡ç†</strong></td>
                        <td>14</td>
                        <td><span class="coverage-badge coverage-none">0%</span></td>
                        <td>å®Œå…¨æœªå¯¾å¿œ</td>
                    </tr>
                </tbody>
            </table>

            <div class="section-title" style="margin-top: 50px;">æ—¢å­˜è¬›åº§ã®å¼·ã¿ã¨å¼±ã¿</div>

            <div class="strength-weakness">
                <div class="strength-box">
                    <h3>âœ“ å¼·ã¿</h3>
                    <ul>
                        <li>å“è³ªç®¡ç†ã®åŸºç¤ã‹ã‚‰å¿œç”¨ã¾ã§ã®ä½“ç³»çš„ã‚«ãƒªã‚­ãƒ¥ãƒ©ãƒ ï¼ˆQCä¸ƒã¤é“å…·ã€PDCAã€å“è³ªä¿è¨¼ï¼‰</li>
                        <li>ãƒ‡ãƒ¼ã‚¿ä¸»ç¾©ã€äº‹å®Ÿã«åŸºã¥ãç®¡ç†ã¨ã„ã£ãŸQCçš„æ€è€ƒæ³•ã®å¾¹åº•çš„ãªæ•™è‚²</li>
                        <li>æ©Ÿæ¢°è¨­è¨ˆãƒ»è£½å›³ã®å®Ÿå‹™çš„æŠ€è¡“æ•™è‚²ã«ã‚ˆã‚‹è¨­è¨ˆç®¡ç†é ˜åŸŸã®éƒ¨åˆ†çš„ã‚µãƒãƒ¼ãƒˆ</li>
                    </ul>
                </div>
                <div class="weakness-box">
                    <h3>âš  å¼±ã¿</h3>
                    <ul>
                        <li>ç”Ÿç”£è¨ˆç”»ã€å·¥ç¨‹ç®¡ç†ã€åœ¨åº«ç®¡ç†ãªã©ã®ç”Ÿç”£ç®¡ç†ä¸­æ ¸é ˜åŸŸãŒå®Œå…¨æ¬ è½</li>
                        <li>åŸä¾¡ç®¡ç†ãƒ»åŸä¾¡è¨ˆç®—ã®ä½“ç³»çš„æ•™è‚²ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®ä¸åœ¨</li>
                        <li>ç´æœŸç®¡ç†ã€é€²æ—ç®¡ç†ã¨ã„ã£ãŸå®Ÿå‹™çš„ãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆæ‰‹æ³•ã®æ¬ å¦‚</li>
                        <li>ç’°å¢ƒç®¡ç†ã€SDGsã€åŠ´åƒå®‰å…¨è¡›ç”Ÿæ³•è¦åˆ¶ãªã©æ³•ä»¤ãƒ»ç¤¾ä¼šçš„è¦è«‹å¯¾å¿œã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®ä¸è¶³</li>
                    </ul>
                </div>
            </div>

            <div class="chart-container" style="margin-top: 40px;">
                <div class="chart-title">ã‚«ãƒãƒ¼ç‡åˆ†å¸ƒï¼ˆç©ã¿ä¸Šã’æ£’ã‚°ãƒ©ãƒ•ï¼‰</div>
                <canvas id="coverageStackedChart"></canvas>
            </div>

            <div
                style="margin-top: 40px; padding: 30px; background: linear-gradient(135deg, #edf2f7 0%, #e2e8f0 100%); border-radius: 12px;">
                <h3 style="color: #2d3748; margin-bottom: 20px; font-size: 1.3em;">ğŸ“ˆ ã‚«ãƒãƒ¼ç‡ã®å†…è¨³</h3>
                <p style="color: #4a5568; line-height: 2;">
                    <strong>å“è³ªç®¡ç†é ˜åŸŸï¼ˆå…±é€šçŸ¥è­˜â… ï¼‰</strong>ã«ãŠã„ã¦68.0%ã®é«˜ã„ã‚«ãƒãƒ¼ç‡ã‚’é”æˆã—ã¦ã„ã¾ã™ã€‚ç‰¹ã«ã€Œå“è³ªç®¡ç†åŸºæœ¬ã‚·ãƒªãƒ¼ã‚ºã€ï¼ˆQCçš„è€ƒãˆæ–¹ã‚³ãƒ¼ã‚¹ã€ç®¡ç†ã‚³ãƒ¼ã‚¹ã€å“è³ªã‚³ãƒ¼ã‚¹ï¼‰ã¯ã€å“è³ªç®¡ç†ã®è€ƒãˆæ–¹ã€ãƒ‡ãƒ¼ã‚¿æ´»ç”¨ã€å“è³ªæ”¹å–„ã®é€²ã‚æ–¹ã«ãŠã„ã¦80-90%ã®å¯¾å¿œç‡ã‚’ç¤ºã—ã€è©¦é¨“å¯¾ç­–ã¨ã—ã¦ååˆ†ã«æ´»ç”¨å¯èƒ½ã§ã™ã€‚<br><br>
                    ä¸€æ–¹ã§ã€ç”Ÿç”£ç®¡ç†ã®ä¸­æ ¸ã‚’ãªã™<strong>å°‚é–€çŸ¥è­˜ã‚»ã‚¯ã‚·ãƒ§ãƒ³å…¨ä½“ã®ã‚«ãƒãƒ¼ç‡ã¯14.6%ã«ç•™ã¾ã‚Šã¾ã™</strong>ã€‚ç‰¹ã«ã€Œâ… .ç”Ÿç”£ã‚·ã‚¹ãƒ†ãƒ ã¨ç”Ÿç”£å½¢æ…‹ã€ã€Œâ…¢.å·¥ç¨‹ç®¡ç†ã«ãŠã‘ã‚‹ç”Ÿç”£è¨ˆç”»ã€ã¯å®Œå…¨æœªå¯¾å¿œï¼ˆ0%ï¼‰ã§ã‚ã‚Šã€ç”Ÿç”£è¨ˆç”»ç«‹æ¡ˆã€å·¥ç¨‹ç®¡ç†ã€åœ¨åº«ç®¡ç†ã€IEæ‰‹æ³•ã¨ã„ã£ãŸç”Ÿç”£ç®¡ç†å›ºæœ‰ã®çŸ¥è­˜é ˜åŸŸã«å¯¾ã™ã‚‹è¬›åº§ãŒå­˜åœ¨ã—ã¾ã›ã‚“ã€‚
                </p>
            </div>

            <div class="section-title" style="margin-top: 50px;">è¬›åº§ä¸€è¦§ã¨è©¦é¨“ç¯„å›²ã®å¯¾å¿œè¡¨</div>

            <div style="margin: 30px 0;">
                <div style="background: #f7fafc; padding: 20px; border-radius: 12px; margin-bottom: 20px;">
                    <p style="color: #4a5568; margin-bottom: 15px;">
                        <strong>å‡¡ä¾‹:</strong>
                        <span
                            style="display: inline-block; margin-left: 15px; padding: 5px 12px; background: #c6f6d5; border-radius: 5px; color: #22543d; font-size: 0.9em;">âœ“
                            é›»æ°—é›»å­ãƒ»æ©Ÿæ¢°è¨­è¨ˆå‘ã‘è¬›åº§ã§å¯¾å¿œ</span>
                        <span
                            style="display: inline-block; margin-left: 10px; padding: 5px 12px; background: #bee3f8; border-radius: 5px; color: #2c5282; font-size: 0.9em;">ğŸ”µ
                            ã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³/ãƒ—ãƒ©ãƒ³ãƒ‹ãƒ³ã‚°ã§è£œå®Œ</span>
                        <span
                            style="display: inline-block; margin-left: 10px; padding: 5px 12px; background: #fed7d7; border-radius: 5px; color: #742a2a; font-size: 0.9em;">æœªå¯¾å¿œ</span>
                    </p>
                    <p style="color: #718096; font-size: 0.95em;">
                        <strong>ãƒ—ãƒ­ã‚·ãƒ¼ã‚ºç¤¾ã®é›»æ°—é›»å­ãƒ»æ©Ÿæ¢°è¨­è¨ˆå‘ã‘è¬›åº§</strong>ã‚’ä¸»è»¸ã«ã€<strong>ã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</strong>ã¨<strong>ãƒ—ãƒ©ãƒ³ãƒ‹ãƒ³ã‚°</strong>ãŒã©ã®ã‚ˆã†ã«è£œå®Œã—ã¦ã„ã‚‹ã‹ã‚’è¡¨ç¤ºã—ã¦ã„ã¾ã™ã€‚
                    </p>
                </div>

                <!-- ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ -->
                <div class="filter-buttons" style="margin-bottom: 20px;">
                    <button class="filter-btn active" id="tab-operation" onclick="switchTableTab('operation')">ğŸ“‹
                        ã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³è©¦é¨“ç¯„å›²</button>
                    <button class="filter-btn" id="tab-planning" onclick="switchTableTab('planning')">ğŸ“‹
                        ãƒ—ãƒ©ãƒ³ãƒ‹ãƒ³ã‚°è©¦é¨“ç¯„å›²</button>
                </div>

                <!-- ã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ã®è¡¨ -->
                <div id="operationTable" style="overflow-x: auto;">
                    <!-- æ¯”è¼ƒè¡¨ã¯JavaScriptã§å‹•çš„ã«ç”Ÿæˆ -->
                </div>

                <!-- ãƒ—ãƒ©ãƒ³ãƒ‹ãƒ³ã‚°ç”¨ã®è¡¨ -->
                <div id="planningTable" style="overflow-x: auto; display: none;">
                    <!-- æ¯”è¼ƒè¡¨ã¯JavaScriptã§å‹•çš„ã«ç”Ÿæˆ -->
                </div>
            </div>
        </div>

        <!-- ãƒšãƒ¼ã‚¸3: æ”¹å–„ææ¡ˆ -->
        <div class="page" id="page3">
            <div class="header">
                <h1>æ”¹å–„ææ¡ˆã¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³</h1>
                <div class="meta">ä»Šå¾Œã®è¬›åº§é–‹ç™ºã«å‘ã‘ãŸå„ªå…ˆé †ä½ä»˜ã‘</div>
            </div>

            <div class="summary-box">
                <h4>ğŸ“‹ ã“ã®ãƒšãƒ¼ã‚¸ã®è¦ç‚¹</h4>
                <ul>
                    <li>æœ€å„ªå…ˆï¼šç”Ÿç”£è¨ˆç”»ãƒ»å·¥ç¨‹ç®¡ç†è¬›åº§ã®é–‹ç™ºï¼ˆã‚«ãƒãƒ¼ç‡+8%ï¼‰</li>
                    <li>é«˜å„ªå…ˆåº¦ï¼šåŸä¾¡ç®¡ç†åŸºç¤è¬›åº§ã®é–‹ç™ºï¼ˆã‚«ãƒãƒ¼ç‡+20%ï¼‰</li>
                    <li>ä¸­å„ªå…ˆåº¦ï¼šè³‡æãƒ»åœ¨åº«ç®¡ç†ã€ç´æœŸç®¡ç†è¬›åº§ã®é–‹ç™º</li>
                    <li>æ¨å¥¨å­¦ç¿’é †åºï¼šå°å…¥æœŸâ†’å±•é–‹æœŸâ†’çµ±åˆæœŸâ†’å®ŒæˆæœŸï¼ˆ7ãƒ¶æœˆï¼‰</li>
                </ul>
            </div>

            <div class="section-title">å„ªå…ˆåº¦åˆ¥æ”¹å–„ææ¡ˆ</div>

            <div class="chart-container">
                <div class="chart-title">æ”¹å–„ææ¡ˆã®å„ªå…ˆåº¦ã¨æœŸå¾…åŠ¹æœ</div>
                <canvas id="proposalImpactChart"></canvas>
            </div>

            <div class="proposal-card">
                <span class="priority">ã€æœ€å„ªå…ˆã€‘</span>
                <h3>1. ç”Ÿç”£è¨ˆç”»ãƒ»å·¥ç¨‹ç®¡ç†è¬›åº§ã®æ–°è¦é–‹ç™º</h3>
                <p><strong>å¯¾è±¡ç¯„å›²:</strong> å°‚é–€çŸ¥è­˜â…¢ã€Œå·¥ç¨‹ç®¡ç†ã«ãŠã‘ã‚‹ç”Ÿç”£è¨ˆç”»ã€ï¼ˆ8é …ç›®ï¼‰</p>
                <ul>
                    <li>ç”Ÿç”£è¨ˆç”»ç«‹æ¡ˆæ‰‹æ³•ã€è² è·ã¨èƒ½åŠ›ã®ãƒãƒ©ãƒ³ã‚·ãƒ³ã‚°</li>
                    <li>ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°åŸºç¤ã€MRPæ¦‚å¿µ</li>
                    <li>ç”Ÿç”£çµ±åˆ¶ã®ä»•çµ„ã¿</li>
                </ul>
                <div class="impact-badge">æœŸå¾…åŠ¹æœ: å…¨ä½“ã‚«ãƒãƒ¼ç‡ã‚’ç´„8%å‘ä¸Š</div>
            </div>

            <div class="proposal-card">
                <span class="priority">ã€é«˜å„ªå…ˆåº¦ã€‘</span>
                <h3>2. åŸä¾¡ç®¡ç†åŸºç¤è¬›åº§ã®é–‹ç™º</h3>
                <p><strong>å¯¾è±¡ç¯„å›²:</strong> å…±é€šçŸ¥è­˜â…¡ã€ŒåŸä¾¡ç®¡ç†ã€ï¼ˆ21é …ç›®ï¼‰</p>
                <ul>
                    <li>åŸä¾¡ã®æ§‹æˆï¼ˆææ–™è²»ãƒ»åŠ´å‹™è²»ãƒ»çµŒè²»ã€å›ºå®šè²»ãƒ»å¤‰å‹•è²»ï¼‰</li>
                    <li>åŸä¾¡è¨ˆç®—æ‰‹æ³•ï¼ˆå®Ÿéš›åŸä¾¡ãƒ»æ¨™æº–åŸä¾¡ï¼‰</li>
                    <li>åŸä¾¡ä¼ç”»ã€åŸä¾¡ä½æ¸›æ‰‹æ³•</li>
                </ul>
                <div class="impact-badge">æœŸå¾…åŠ¹æœ: å…¨ä½“ã‚«ãƒãƒ¼ç‡ã‚’ç´„20%å‘ä¸Šï¼ˆæœ€å¤§ã®æœªå¯¾å¿œé ˜åŸŸã‚’è§£æ¶ˆï¼‰</div>
            </div>

            <div class="proposal-card">
                <span class="priority">ã€ä¸­å„ªå…ˆåº¦ã€‘</span>
                <h3>3. è³‡æãƒ»åœ¨åº«ç®¡ç†ã¨ç”Ÿç”£ã‚·ã‚¹ãƒ†ãƒ è¬›åº§ã®é–‹ç™º</h3>
                <p><strong>å¯¾è±¡ç¯„å›²:</strong> å°‚é–€çŸ¥è­˜â…£ã€Œè³‡æãƒ»åœ¨åº«ç®¡ç†ã¨ç”Ÿç”£ã‚·ã‚¹ãƒ†ãƒ ã€ï¼ˆ6é …ç›®ï¼‰</p>
                <ul>
                    <li>éƒ¨å“å±•é–‹ï¼ˆBOMï¼‰ã€åœ¨åº«ç®¡ç†æ–¹å¼ï¼ˆå®šé‡ç™ºæ³¨ãƒ»å®šæœŸç™ºæ³¨ãƒ»ABCåˆ†æï¼‰</li>
                    <li>IEåŸºç¤ï¼ˆå‹•ä½œç ”ç©¶ãƒ»æ™‚é–“ç ”ç©¶ï¼‰</li>
                    <li>å·¥ç¨‹ç·¨æˆã¨ãƒ©ã‚¤ãƒ³ãƒãƒ©ãƒ³ã‚·ãƒ³ã‚°</li>
                </ul>
                <div class="impact-badge">æœŸå¾…åŠ¹æœ: ç”Ÿç”£ç¾å ´ã®å®Ÿå‹™çš„ç®¡ç†æ‰‹æ³•ã‚’è£œå®Œ</div>
            </div>

            <div class="proposal-card">
                <span class="priority">ã€ä¸­å„ªå…ˆåº¦ã€‘</span>
                <h3>4. ç´æœŸç®¡ç†ãƒ»é€²æ—ç®¡ç†è¬›åº§ã®é–‹ç™º</h3>
                <p><strong>å¯¾è±¡ç¯„å›²:</strong> å…±é€šçŸ¥è­˜â…¢ã€Œç´æœŸç®¡ç†ã€ï¼ˆ11é …ç›®ï¼‰</p>
                <ul>
                    <li>ç´æœŸé…å»¶è¦å› åˆ†æ</li>
                    <li>é€²æ—ç®¡ç†æ‰‹æ³•ï¼ˆã‚¬ãƒ³ãƒˆãƒãƒ£ãƒ¼ãƒˆã€PERTï¼‰</li>
                    <li>ç›®ã§è¦‹ã‚‹ç®¡ç†ï¼ˆå¯è¦–åŒ–æ‰‹æ³•ï¼‰</li>
                </ul>
                <div class="impact-badge">æœŸå¾…åŠ¹æœ: QCDç®¡ç†ã®ã€ŒDï¼ˆç´æœŸï¼‰ã€é ˜åŸŸã‚’å¼·åŒ–</div>
            </div>

            <div class="proposal-card">
                <span class="priority">ã€ä½å„ªå…ˆåº¦ã€‘</span>
                <h3>5. ç’°å¢ƒç®¡ç†ãƒ»SDGsè¬›åº§ã®é–‹ç™º</h3>
                <p><strong>å¯¾è±¡ç¯„å›²:</strong> å…±é€šçŸ¥è­˜â…¤ã€Œç’°å¢ƒç®¡ç†ã€ï¼ˆ14é …ç›®ï¼‰</p>
                <ul>
                    <li>ç’°å¢ƒåŸºæœ¬æ³•ã€å…¬å®³é˜²æ­¢å¯¾ç­–ï¼ˆå¤§æ°—ãƒ»æ°´è³ªãƒ»åœŸå£Œãƒ»é¨’éŸ³ï¼‰</li>
                    <li>ç’°å¢ƒãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ ï¼ˆISO14001ï¼‰</li>
                    <li>SDGs17ã‚´ãƒ¼ãƒ«ã¨è£½é€ æ¥­ã®å–ã‚Šçµ„ã¿</li>
                </ul>
                <div class="impact-badge">æœŸå¾…åŠ¹æœ: ç¾ä»£çš„ãªç¤¾ä¼šçš„è¦è«‹ã¸ã®å¯¾å¿œã€ä¼æ¥­ã®æŒç¶šå¯èƒ½æ€§æ•™è‚²</div>
            </div>

            <div class="section-title" style="margin-top: 50px;">æ¨å¥¨å­¦ç¿’é †åº</div>

            <div style="background: #f7fafc; padding: 30px; border-radius: 12px; margin: 30px 0;">
                <div style="display: grid; gap: 20px;">
                    <div style="padding: 20px; background: white; border-radius: 8px; border-left: 5px solid #667eea;">
                        <h4 style="color: #667eea; margin-bottom: 10px;">1. å°å…¥æœŸï¼ˆ1-2ãƒ¶æœˆç›®ï¼‰</h4>
                        <p>å“è³ªç®¡ç†åŸºæœ¬ã‚·ãƒªãƒ¼ã‚ºã§åŸºç¤çš„ãªç®¡ç†æ€è€ƒï¼ˆPDCAã€ãƒ‡ãƒ¼ã‚¿ä¸»ç¾©ï¼‰ã‚’ç¿’å¾—</p>
                    </div>
                    <div style="padding: 20px; background: white; border-radius: 8px; border-left: 5px solid #667eea;">
                        <h4 style="color: #667eea; margin-bottom: 10px;">2. å±•é–‹æœŸï¼ˆ3-4ãƒ¶æœˆç›®ï¼‰</h4>
                        <p>ç”Ÿç”£è¨ˆç”»ãƒ»å·¥ç¨‹ç®¡ç†ã€è³‡æãƒ»åœ¨åº«ç®¡ç†ã§ç”Ÿç”£ç®¡ç†ã®ä¸­æ ¸ã‚’å­¦ç¿’</p>
                    </div>
                    <div style="padding: 20px; background: white; border-radius: 8px; border-left: 5px solid #667eea;">
                        <h4 style="color: #667eea; margin-bottom: 10px;">3. çµ±åˆæœŸï¼ˆ5-6ãƒ¶æœˆç›®ï¼‰</h4>
                        <p>åŸä¾¡ç®¡ç†ã€ç´æœŸç®¡ç†ã€è¨­è¨ˆç®¡ç†ã§å¤šè§’çš„ãªç®¡ç†è¦–ç‚¹ã‚’çµ±åˆ</p>
                    </div>
                    <div style="padding: 20px; background: white; border-radius: 8px; border-left: 5px solid #667eea;">
                        <h4 style="color: #667eea; margin-bottom: 10px;">4. å®ŒæˆæœŸï¼ˆ7ãƒ¶æœˆç›®ï¼‰</h4>
                        <p>å®‰å…¨è¡›ç”Ÿç®¡ç†ã€ç’°å¢ƒç®¡ç†ã§æ³•ä»¤ãƒ»ç¤¾ä¼šçš„è²¬ä»»ã‚’ç†è§£</p>
                    </div>
                </div>
            </div>

            <div
                style="margin-top: 40px; padding: 30px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border-radius: 12px;">
                <h3 style="margin-bottom: 20px; font-size: 1.5em;">ğŸ’¡ ã‚¹ã‚­ãƒ«é€£å‹•ã®è¦³ç‚¹</h3>
                <p style="line-height: 2; font-size: 1.05em;">
                    æ—¢å­˜ã®ã€Œå“è³ªç®¡ç†åŸºæœ¬ã‚·ãƒªãƒ¼ã‚ºã€ã¯ã€ç”Ÿç”£ç®¡ç†ã®åŸºç›¤ã¨ãªã‚‹<strong>å•é¡Œè§£æ±ºæ€è€ƒã¨ãƒ‡ãƒ¼ã‚¿åˆ†æã‚¹ã‚­ãƒ«</strong>ã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚æ–°è¦é–‹ç™ºè¬›åº§ã§ã¯ã€ã“ã‚Œã‚‰ã®ã‚¹ã‚­ãƒ«ã‚’å‰æã¨ã—ã¦ã€ç”Ÿç”£è¨ˆç”»ã«ãŠã‘ã‚‹ãƒ‡ãƒ¼ã‚¿æ´»ç”¨ï¼ˆéœ€è¦äºˆæ¸¬ã€è² è·åˆ†æï¼‰ã€åŸä¾¡ç®¡ç†ã«ãŠã‘ã‚‹ãƒ‡ãƒ¼ã‚¿åˆ†æï¼ˆå·®ç•°åˆ†æã€åŸä¾¡ä½æ¸›åŠ¹æœæ¸¬å®šï¼‰ã¨ã„ã£ãŸå¿œç”¨å±•é–‹ã‚’å›³ã‚‹ã“ã¨ã§ã€å­¦ç¿’åŠ¹æœãŒç›¸ä¹—çš„ã«é«˜ã¾ã‚‹è¨­è¨ˆãŒæœ›ã¾ã—ã„ã§ã™ã€‚
                </p>
            </div>
        </div>
    </div>

    <div class="page-navigation">
        <button onclick="goToPage(1)">1</button>
        <button onclick="goToPage(2)">2</button>
        <button onclick="goToPage(3)">3</button>
    </div>

    <script>
        let currentPage = 1;
        const totalPages = 3;

        function goToPage(pageNum) {
            currentPage = pageNum;
            const page = document.getElementById(`page${pageNum}`);
            if (page) {
                page.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
            updateNavigation();
        }

        function updateNavigation() {
            const buttons = document.querySelectorAll('.page-navigation button');
            buttons.forEach((btn, index) => {
                if (index + 1 === currentPage) {
                    btn.style.background = '#764ba2';
                } else {
                    btn.style.background = '#667eea';
                }
            });
        }

        // åˆæœŸåŒ–
        updateNavigation();

        // Chart.jsã®è¨­å®š
        Chart.defaults.font.family = "'Hiragino Sans', 'Hiragino Kaku Gothic ProN', 'Yu Gothic', 'Meiryo', sans-serif";
        Chart.defaults.font.size = 12;
        Chart.defaults.color = '#4a5568';

        // ãƒšãƒ¼ã‚¸1: å°‚é–€çŸ¥è­˜ vs å…±é€šçŸ¥è­˜ ã‚«ãƒãƒ¼ç‡æ¯”è¼ƒ
        const ctx1 = document.getElementById('coverageComparisonChart');
        if (ctx1) {
            new Chart(ctx1, {
                type: 'bar',
                data: {
                    labels: ['å°‚é–€çŸ¥è­˜', 'å…±é€šçŸ¥è­˜', 'å…¨ä½“'],
                    datasets: [{
                        label: 'ã‚«ãƒãƒ¼ç‡ (%)',
                        data: [14.6, 21.9, 20.1],
                        backgroundColor: [
                            'rgba(102, 126, 234, 0.8)',
                            'rgba(118, 75, 162, 0.8)',
                            'rgba(102, 126, 234, 0.6)'
                        ],
                        borderColor: [
                            'rgba(102, 126, 234, 1)',
                            'rgba(118, 75, 162, 1)',
                            'rgba(102, 126, 234, 1)'
                        ],
                        borderWidth: 2,
                        borderRadius: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function (context) {
                                    return 'ã‚«ãƒãƒ¼ç‡: ' + context.parsed.y + '%';
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: function (value) {
                                    return value + '%';
                                }
                            }
                        }
                    }
                }
            });
        }

        // ãƒšãƒ¼ã‚¸1: å¯¾å¿œçŠ¶æ³ã®å†…è¨³ï¼ˆãƒ‰ãƒ¼ãƒŠãƒ„ãƒãƒ£ãƒ¼ãƒˆï¼‰
        const ctx2 = document.getElementById('coverageStatusChart');
        if (ctx2) {
            new Chart(ctx2, {
                type: 'doughnut',
                data: {
                    labels: ['å®Œå…¨å¯¾å¿œ (80%ä»¥ä¸Š)', 'ä¸€éƒ¨å¯¾å¿œ (50-79%)', 'é™å®šçš„å¯¾å¿œ (1-49%)', 'æœªå¯¾å¿œ (0%)'],
                    datasets: [{
                        data: [6, 18, 15, 64],
                        backgroundColor: [
                            'rgba(34, 197, 94, 0.8)',
                            'rgba(251, 191, 36, 0.8)',
                            'rgba(251, 146, 60, 0.8)',
                            'rgba(226, 232, 240, 0.8)'
                        ],
                        borderColor: [
                            'rgba(34, 197, 94, 1)',
                            'rgba(251, 191, 36, 1)',
                            'rgba(251, 146, 60, 1)',
                            'rgba(226, 232, 240, 1)'
                        ],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 15,
                                font: {
                                    size: 11
                                }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function (context) {
                                    const label = context.label || '';
                                    const value = context.parsed || 0;
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const percentage = ((value / total) * 100).toFixed(1);
                                    return label + ': ' + value + 'é …ç›® (' + percentage + '%)';
                                }
                            }
                        }
                    }
                }
            });
        }

        // ãƒšãƒ¼ã‚¸2: å°‚é–€çŸ¥è­˜ã‚»ã‚¯ã‚·ãƒ§ãƒ³åˆ¥ã‚«ãƒãƒ¼ç‡
        const ctx3 = document.getElementById('specializedKnowledgeChart');
        if (ctx3) {
            new Chart(ctx3, {
                type: 'bar',
                data: {
                    labels: ['â… . ç”Ÿç”£ã‚·ã‚¹ãƒ†ãƒ ã¨ç”Ÿç”£å½¢æ…‹', 'â…¡. è£½å“ä¼ç”»ã¨è¨­è¨ˆç®¡ç†', 'â…¢. å·¥ç¨‹ç®¡ç†ã«ãŠã‘ã‚‹ç”Ÿç”£è¨ˆç”»', 'â…£. è³‡æãƒ»åœ¨åº«ç®¡ç†ã¨ç”Ÿç”£ã‚·ã‚¹ãƒ†ãƒ '],
                    datasets: [{
                        label: 'ã‚«ãƒãƒ¼ç‡ (%)',
                        data: [0, 45.7, 0, 10.0],
                        backgroundColor: function (context) {
                            const value = context.parsed.y;
                            if (value >= 50) return 'rgba(34, 197, 94, 0.8)';
                            if (value >= 1) return 'rgba(251, 146, 60, 0.8)';
                            return 'rgba(226, 232, 240, 0.8)';
                        },
                        borderColor: function (context) {
                            const value = context.parsed.y;
                            if (value >= 50) return 'rgba(34, 197, 94, 1)';
                            if (value >= 1) return 'rgba(251, 146, 60, 1)';
                            return 'rgba(226, 232, 240, 1)';
                        },
                        borderWidth: 2,
                        borderRadius: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    indexAxis: 'y',
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function (context) {
                                    return 'ã‚«ãƒãƒ¼ç‡: ' + context.parsed.x + '%';
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: function (value) {
                                    return value + '%';
                                }
                            }
                        }
                    }
                }
            });
        }

        // ãƒšãƒ¼ã‚¸2: å…±é€šçŸ¥è­˜ã‚»ã‚¯ã‚·ãƒ§ãƒ³åˆ¥ã‚«ãƒãƒ¼ç‡
        const ctx4 = document.getElementById('commonKnowledgeChart');
        if (ctx4) {
            new Chart(ctx4, {
                type: 'bar',
                data: {
                    labels: ['â… . å“è³ªç®¡ç†', 'â…¡. åŸä¾¡ç®¡ç†', 'â…¢. ç´æœŸç®¡ç†', 'â…£. å®‰å…¨è¡›ç”Ÿç®¡ç†', 'â…¤. ç’°å¢ƒç®¡ç†'],
                    datasets: [{
                        label: 'ã‚«ãƒãƒ¼ç‡ (%)',
                        data: [68.0, 0, 0, 30.0, 0],
                        backgroundColor: function (context) {
                            const value = context.parsed.y;
                            if (value >= 50) return 'rgba(34, 197, 94, 0.8)';
                            if (value >= 1) return 'rgba(251, 146, 60, 0.8)';
                            return 'rgba(226, 232, 240, 0.8)';
                        },
                        borderColor: function (context) {
                            const value = context.parsed.y;
                            if (value >= 50) return 'rgba(34, 197, 94, 1)';
                            if (value >= 1) return 'rgba(251, 146, 60, 1)';
                            return 'rgba(226, 232, 240, 1)';
                        },
                        borderWidth: 2,
                        borderRadius: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    indexAxis: 'y',
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function (context) {
                                    return 'ã‚«ãƒãƒ¼ç‡: ' + context.parsed.x + '%';
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: function (value) {
                                    return value + '%';
                                }
                            }
                        }
                    }
                }
            });
        }

        // ãƒšãƒ¼ã‚¸2: ã‚«ãƒãƒ¼ç‡åˆ†å¸ƒï¼ˆç©ã¿ä¸Šã’æ£’ã‚°ãƒ©ãƒ•ï¼‰
        const ctx5 = document.getElementById('coverageStackedChart');
        if (ctx5) {
            new Chart(ctx5, {
                type: 'bar',
                data: {
                    labels: ['å°‚é–€çŸ¥è­˜', 'å…±é€šçŸ¥è­˜', 'å…¨ä½“'],
                    datasets: [
                        {
                            label: 'å®Œå…¨å¯¾å¿œ (80%ä»¥ä¸Š)',
                            data: [0, 6, 6],
                            backgroundColor: 'rgba(34, 197, 94, 0.8)',
                            borderColor: 'rgba(34, 197, 94, 1)',
                            borderWidth: 1
                        },
                        {
                            label: 'ä¸€éƒ¨å¯¾å¿œ (50-79%)',
                            data: [4, 14, 18],
                            backgroundColor: 'rgba(251, 191, 36, 0.8)',
                            borderColor: 'rgba(251, 191, 36, 1)',
                            borderWidth: 1
                        },
                        {
                            label: 'é™å®šçš„å¯¾å¿œ (1-49%)',
                            data: [4, 11, 15],
                            backgroundColor: 'rgba(251, 146, 60, 0.8)',
                            borderColor: 'rgba(251, 146, 60, 1)',
                            borderWidth: 1
                        },
                        {
                            label: 'æœªå¯¾å¿œ (0%)',
                            data: [18, 46, 64],
                            backgroundColor: 'rgba(226, 232, 240, 0.8)',
                            borderColor: 'rgba(226, 232, 240, 1)',
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 15,
                                font: {
                                    size: 11
                                }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                footer: function (tooltipItems) {
                                    let total = 0;
                                    tooltipItems.forEach(function (tooltipItem) {
                                        total += tooltipItem.parsed.y;
                                    });
                                    return 'åˆè¨ˆ: ' + total + 'é …ç›®';
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            stacked: true
                        },
                        y: {
                            stacked: true,
                            beginAtZero: true,
                            ticks: {
                                stepSize: 10
                            }
                        }
                    }
                }
            });
        }

        // ãƒšãƒ¼ã‚¸3: æ”¹å–„ææ¡ˆã®å„ªå…ˆåº¦ã¨æœŸå¾…åŠ¹æœ
        const ctx6 = document.getElementById('proposalImpactChart');
        if (ctx6) {
            new Chart(ctx6, {
                type: 'bar',
                data: {
                    labels: ['ç”Ÿç”£è¨ˆç”»ãƒ»å·¥ç¨‹ç®¡ç†', 'åŸä¾¡ç®¡ç†åŸºç¤', 'è³‡æãƒ»åœ¨åº«ç®¡ç†', 'ç´æœŸç®¡ç†ãƒ»é€²æ—ç®¡ç†', 'ç’°å¢ƒç®¡ç†ãƒ»SDGs'],
                    datasets: [{
                        label: 'æœŸå¾…åŠ¹æœï¼ˆã‚«ãƒãƒ¼ç‡å‘ä¸Š%ï¼‰',
                        data: [8, 20, 6, 11, 14],
                        backgroundColor: function (context) {
                            const index = context.dataIndex;
                            if (index === 0) return 'rgba(239, 68, 68, 0.8)'; // æœ€å„ªå…ˆ
                            if (index === 1) return 'rgba(251, 146, 60, 0.8)'; // é«˜å„ªå…ˆåº¦
                            return 'rgba(102, 126, 234, 0.8)'; // ä¸­ãƒ»ä½å„ªå…ˆåº¦
                        },
                        borderColor: function (context) {
                            const index = context.dataIndex;
                            if (index === 0) return 'rgba(239, 68, 68, 1)';
                            if (index === 1) return 'rgba(251, 146, 60, 1)';
                            return 'rgba(102, 126, 234, 1)';
                        },
                        borderWidth: 2,
                        borderRadius: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    indexAxis: 'y',
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function (context) {
                                    return 'æœŸå¾…åŠ¹æœ: ã‚«ãƒãƒ¼ç‡ã‚’ç´„' + context.parsed.x + '%å‘ä¸Š';
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            beginAtZero: true,
                            max: 25,
                            ticks: {
                                callback: function (value) {
                                    return value + '%';
                                }
                            }
                        }
                    }
                }
            });
        }

        // CSVãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã¨æ¯”è¼ƒè¡¨ã®ç”Ÿæˆ
        async function loadCSVAndGenerateTable() {
            try {
                // CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚€
                const [operationCSV, planningCSV, courseCSV] = await Promise.all([
                    fetch('ç”Ÿç”£ç®¡ç†ã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³.csv').then(r => r.text()),
                    fetch('ç”Ÿç”£ç®¡ç†ãƒ—ãƒ©ãƒ³ãƒ‹ãƒ³ã‚°.csv').then(r => r.text()),
                    fetch('é›»æ°—é›»å­ãƒ»æ©Ÿæ¢°è¨­è¨ˆå‘ã‘.csv').then(r => r.text())
                ]);

                // CSVã‚’ãƒ‘ãƒ¼ã‚¹
                const operationData = parseCSV(operationCSV);
                const planningData = parseCSV(planningCSV);
                const courseData = parseCourseCSV(courseCSV);

                // æ¯”è¼ƒè¡¨ã‚’ç”Ÿæˆï¼ˆã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¨ãƒ—ãƒ©ãƒ³ãƒ‹ãƒ³ã‚°ã‚’åˆ†ã‘ã¦ï¼‰
                generateComparisonTable(operationData, planningData, courseData);
            } catch (error) {
                console.error('CSVãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
                // ã‚¨ãƒ©ãƒ¼æ™‚ã¯ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã¨ã—ã¦ç°¡æ˜“ç‰ˆã‚’è¡¨ç¤º
                generateFallbackTable();
            }
        }

        function parseCSV(csvText) {
            const lines = csvText.split('\n');
            const data = [];
            let currentSection = '';
            let currentSubsection = '';

            for (let i = 1; i < lines.length; i++) {
                const line = lines[i].trim();
                if (!line) continue;

                const cols = line.split(',').map(c => c.trim());
                if (cols.length < 4) continue;

                const [category, major, middle, minor] = cols;

                if (category && category.includes('å°‚é–€çŸ¥è­˜') || category.includes('å…±é€šçŸ¥è­˜')) {
                    currentSection = category;
                }
                if (major && major.match(/^[â… -â…¤]/)) {
                    currentSubsection = major;
                }

                if (minor && minor.startsWith('ï¼ˆ')) {
                    data.push({
                        category: currentSection,
                        major: currentSubsection,
                        middle: middle || '',
                        minor: minor
                    });
                }
            }
            return data;
        }

        function parseCourseCSV(csvText) {
            const lines = csvText.split('\n');
            const courses = [];
            let currentCourse = '';

            for (let i = 0; i < lines.length; i++) {
                const line = lines[i].trim();
                if (!line || line === ',') continue;

                // è¬›åº§åã®è¡Œã‚’æ¤œå‡ºï¼ˆã‚«ãƒ³ãƒãŒ1ã¤ã ã‘ã€ã¾ãŸã¯æœ€åˆã®ã‚«ãƒ©ãƒ ãŒç©ºã§ãªã„ï¼‰
                if (!line.includes(',') || line.split(',').filter(c => c.trim()).length === 1) {
                    if (line && !line.startsWith('No.') && !line.startsWith('ç« ãƒ»ç¯€')) {
                        currentCourse = line.split(',')[0].trim();
                        if (currentCourse) {
                            courses.push({
                                name: currentCourse,
                                items: []
                            });
                        }
                    }
                } else {
                    // è¬›åº§ã®é …ç›®ã‚’è¿½åŠ 
                    const cols = line.split(',');
                    if (cols.length >= 2 && cols[1].trim()) {
                        const item = cols[1].trim();
                        if (item && !item.match(/^\d+$/)) {
                            if (courses.length > 0) {
                                courses[courses.length - 1].items.push(item);
                            }
                        }
                    }
                }
            }
            return courses;
        }

        function checkMatch(examItem, courseItems) {
            // ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒãƒãƒ³ã‚°
            const keywords = extractKeywords(examItem);
            for (const courseItem of courseItems) {
                for (const keyword of keywords) {
                    if (courseItem.includes(keyword) || keyword.includes(courseItem)) {
                        return true;
                    }
                }
            }
            return false;
        }

        function extractKeywords(text) {
            // æ‹¬å¼§å†…ã®ãƒ†ã‚­ã‚¹ãƒˆã‚„ä¸»è¦ãªã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’æŠ½å‡º
            const keywords = [];
            // æ‹¬å¼§å†…ã®ãƒ†ã‚­ã‚¹ãƒˆ
            const matches = text.match(/ï¼ˆ([^ï¼‰]+)ï¼‰/g);
            if (matches) {
                matches.forEach(m => keywords.push(m.replace(/[ï¼ˆï¼‰]/g, '')));
            }
            // ä¸»è¦ãªå˜èª
            const words = text.replace(/[ï¼ˆï¼‰ã€ã€‚]/g, ' ').split(/\s+/).filter(w => w.length > 1);
            keywords.push(...words);
            return keywords;
        }

        function generateComparisonTable(operationData, planningData, courseData) {
            const operationContainer = document.getElementById('operationTable');
            const planningContainer = document.getElementById('planningTable');

            if (!operationContainer || !planningContainer) return;

            // é›»æ°—é›»å­ãƒ»æ©Ÿæ¢°è¨­è¨ˆå‘ã‘è¬›åº§ã‚’ä¸»è»¸ã¨ã—ã¦ä½¿ç”¨
            const mainCourses = courseData.filter(c =>
                c.name.includes('å“è³ªç®¡ç†') ||
                c.name.includes('è¨­è¨ˆ') ||
                c.name.includes('åŠ å·¥') ||
                c.name.includes('ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹') ||
                c.name.includes('æ©Ÿæ¢°') ||
                c.name.includes('é›»æ°—')
            );

            // ã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ã®è¡¨ã‚’ç”Ÿæˆ
            generateTableForExam(operationContainer, operationData, mainCourses, 'ã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³');

            // ãƒ—ãƒ©ãƒ³ãƒ‹ãƒ³ã‚°ç”¨ã®è¡¨ã‚’ç”Ÿæˆ
            generateTableForExam(planningContainer, planningData, mainCourses, 'ãƒ—ãƒ©ãƒ³ãƒ‹ãƒ³ã‚°');
        }

        function generateTableForExam(container, examData, courseData, examType) {
            let html = '<table class="comparison-table"><thead><tr>';
            html += '<th style="width: 10%;">åŒºåˆ†</th>';
            html += '<th style="width: 15%;">å¤§åˆ†é¡</th>';
            html += '<th style="width: 20%;">ä¸­åˆ†é¡</th>';
            html += '<th style="width: 35%;">å°åˆ†é¡ï¼ˆè©¦é¨“ç¯„å›²ï¼‰</th>';
            html += '<th style="width: 20%;">å¯¾å¿œå¯å¦</th>';
            html += '</tr></thead><tbody>';

            let currentCategory = '';
            let currentMajor = '';

            for (const item of examData) {
                // ã‚«ãƒ†ã‚´ãƒªãƒ˜ãƒƒãƒ€ãƒ¼
                if (item.category !== currentCategory) {
                    currentCategory = item.category;
                    html += `<tr class="section-header"><td colspan="5"><strong>${item.category}</strong></td></tr>`;
                }

                // å¤§åˆ†é¡ãƒ˜ãƒƒãƒ€ãƒ¼
                if (item.major !== currentMajor) {
                    currentMajor = item.major;
                    html += `<tr class="subsection-header"><td colspan="5">${item.major}</td></tr>`;
                }

                // é›»æ°—é›»å­ãƒ»æ©Ÿæ¢°è¨­è¨ˆå‘ã‘è¬›åº§ã§ä¸€è‡´ã™ã‚‹ã‚‚ã®ã‚’æ¤œç´¢
                const matchingCourses = [];
                for (const course of courseData) {
                    if (checkMatch(item.minor, course.items)) {
                        matchingCourses.push(course.name);
                    }
                }

                html += '<tr>';
                html += `<td>${item.category.replace(/[ã€ã€‘]/g, '')}</td>`;
                html += `<td>${item.major}</td>`;
                html += `<td>${item.middle}</td>`;
                html += `<td>${item.minor}</td>`;
                
                if (matchingCourses.length > 0) {
                    // å¯¾å¿œå¯èƒ½
                    html += `<td class="match-cell">âœ“ å¯¾å¿œå¯èƒ½<br><small style="font-size: 0.85em; opacity: 0.8;">${matchingCourses[0]}</small></td>`;
                } else {
                    // å¯¾å¿œä¸å¯
                    html += '<td class="no-match-cell">âœ— å¯¾å¿œä¸å¯</td>';
                }
                html += '</tr>';
            }

            html += '</tbody></table>';
            container.innerHTML = html;
        }

        // ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆæ©Ÿèƒ½
        function switchTableTab(type) {
            const operationTab = document.getElementById('tab-operation');
            const planningTab = document.getElementById('tab-planning');
            const operationTable = document.getElementById('operationTable');
            const planningTable = document.getElementById('planningTable');

            if (type === 'operation') {
                operationTab.classList.add('active');
                planningTab.classList.remove('active');
                operationTable.style.display = 'block';
                planningTable.style.display = 'none';
            } else {
                operationTab.classList.remove('active');
                planningTab.classList.add('active');
                operationTable.style.display = 'none';
                planningTable.style.display = 'block';
            }
        }

        function generateFallbackTable() {
            const operationContainer = document.getElementById('operationTable');
            const planningContainer = document.getElementById('planningTable');

            const fallbackHTML = `
                <div style="padding: 40px; text-align: center; color: #718096;">
                    <p>CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚“ã§ã„ã¾ã™...</p>
                    <p style="font-size: 0.9em; margin-top: 10px;">ãƒ•ã‚¡ã‚¤ãƒ«ãŒèª­ã¿è¾¼ã‚ãªã„å ´åˆã¯ã€ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚</p>
                </div>
            `;

            if (operationContainer) operationContainer.innerHTML = fallbackHTML;
            if (planningContainer) planningContainer.innerHTML = fallbackHTML;
        }

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«å®Ÿè¡Œ
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', loadCSVAndGenerateTable);
        } else {
            loadCSVAndGenerateTable();
        }

        // æ¤œç´¢æ©Ÿèƒ½
        const searchInput = document.getElementById('searchInput');
        if (searchInput) {
            searchInput.addEventListener('input', function (e) {
                const searchTerm = e.target.value.toLowerCase();
                highlightSearchTerm(searchTerm);
            });
        }

        function highlightSearchTerm(term) {
            if (!term) {
                // ãƒã‚¤ãƒ©ã‚¤ãƒˆã‚’å‰Šé™¤
                document.querySelectorAll('.highlight').forEach(el => {
                    const parent = el.parentNode;
                    parent.replaceChild(document.createTextNode(el.textContent), el);
                    parent.normalize();
                });
                return;
            }

            // ãƒ†ã‚­ã‚¹ãƒˆãƒãƒ¼ãƒ‰ã‚’æ¤œç´¢ã—ã¦ãƒã‚¤ãƒ©ã‚¤ãƒˆ
            const walker = document.createTreeWalker(
                document.body,
                NodeFilter.SHOW_TEXT,
                null,
                false
            );

            const textNodes = [];
            let node;
            while (node = walker.nextNode()) {
                if (node.textContent.toLowerCase().includes(term)) {
                    textNodes.push(node);
                }
            }

            textNodes.forEach(textNode => {
                const parent = textNode.parentNode;
                if (parent.classList.contains('highlight')) return;

                const text = textNode.textContent;
                const regex = new RegExp(`(${term})`, 'gi');
                const highlightedText = text.replace(regex, '<span class="highlight">$1</span>');

                if (highlightedText !== text) {
                    const wrapper = document.createElement('span');
                    wrapper.innerHTML = highlightedText;
                    parent.replaceChild(wrapper, textNode);
                }
            });
        }

        // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ©Ÿèƒ½
        function filterTable(type, event) {
            // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒœã‚¿ãƒ³ã®çŠ¶æ…‹ã‚’æ›´æ–°
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            if (event && event.target) {
                event.target.classList.add('active');
            }

            const table = document.querySelector('.comparison-table');
            if (!table) return;

            const rows = table.querySelectorAll('tbody tr');
            rows.forEach(row => {
                if (row.classList.contains('section-header') || row.classList.contains('subsection-header')) {
                    row.style.display = '';
                    return;
                }

                const matchCell = row.querySelector('.match-cell');
                const noMatchCell = row.querySelector('.no-match-cell');
                const category = row.cells[0]?.textContent || '';

                let show = true;
                switch (type) {
                    case 'match':
                        show = !!matchCell;
                        break;
                    case 'no-match':
                        show = !!noMatchCell;
                        break;
                    case 'specialized':
                        show = category.includes('å°‚é–€çŸ¥è­˜');
                        break;
                    case 'common':
                        show = category.includes('å…±é€šçŸ¥è­˜');
                        break;
                    default:
                        show = true;
                }

                row.style.display = show ? '' : 'none';
            });
        }

        // å°åˆ·æ©Ÿèƒ½
        function printReport() {
            window.print();
        }

        // PDFã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæ©Ÿèƒ½ï¼ˆç°¡æ˜“ç‰ˆï¼‰
        function exportToPDF() {
            alert('PDFã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæ©Ÿèƒ½ã‚’ä½¿ç”¨ã™ã‚‹ã«ã¯ã€ãƒ–ãƒ©ã‚¦ã‚¶ã®ã€Œå°åˆ·ã€æ©Ÿèƒ½ã‹ã‚‰ã€ŒPDFã«ä¿å­˜ã€ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚');
            window.print();
        }

        // ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«æ™‚ã®ç›®æ¬¡ãƒã‚¤ãƒ©ã‚¤ãƒˆ
        function updateTOCHighlight() {
            const pages = document.querySelectorAll('.page');
            const tocItems = document.querySelectorAll('.toc-item');

            let currentPage = 1;
            pages.forEach((page, index) => {
                const rect = page.getBoundingClientRect();
                if (rect.top <= 100 && rect.bottom >= 100) {
                    currentPage = index + 1;
                }
            });

            tocItems.forEach((item, index) => {
                if (index + 1 === currentPage) {
                    item.classList.add('active');
                } else {
                    item.classList.remove('active');
                }
            });
        }

        window.addEventListener('scroll', updateTOCHighlight);
        updateTOCHighlight();
    </script>
</body>

</html>
